# AGENTS.md

본 문서는 이 리포지터리에서 에이전트(코딩 보조 도구, 예: Codex CLI)가 작업할 때 따라야 할 규칙과 절차를 정의합니다. 문서의 범위는 리포지터리 루트부터 하위 전체 디렉터리에 적용됩니다.

## 목적과 범위
- 이 리포지터리에서 수행되는 자동화/반자동화 코딩 작업의 일관성, 안전성, 재현성을 보장합니다.
- 사람이 요청한 작업을 에이전트가 수행할 때의 기본 원칙과 실행 순서를 명확히 합니다.

## 기본 원칙
- 최소 변경: 요청 범위를 벗어나지 않는 선에서 필요한 변경만 수행합니다.
- 명확성: 변경 이유와 사용법이 드러나도록 파일/코드/커밋 메시지(사람이 커밋 시)를 간결히 설명합니다.
- 안전성: 파괴적 작업(파일 삭제/대체/대규모 리팩터) 전에는 반드시 사용자 확인을 받습니다.
- 한국어 우선: 별도 요청이 없으면 한글로 소통합니다. 코드/식별자/CLI 옵션 등은 원문 유지.
- 문서 우선: 변경 전/후에 `docs/medical-recording-prd.md`, `docs/developing.md`를 참고하여 요구사항과 향후 계획을 일치시킵니다.

## 권장 작업 흐름
1) 맥락 파악: 기존 파일 구조를 탐색하고, PRD/Devel 문서의 최신 상태를 요약합니다.
2) 계획 수립: 3–6단계의 짧은 계획을 제시하고, `update_plan` 도구로 단계별 진행 상황을 갱신합니다.
3) 변경 수행: 실제 수정은 반드시 `apply_patch` 형식으로 제안합니다(파일 추가/수정/삭제). ASCII 기본, 불필요한 공백 변경 금지.
4) 검증: 영향 범위 내에서 `flutter analyze`, `flutter test`, 사용자 지정 스크립트 등 빠른 검증을 우선 실행합니다. 실행이 불가하거나 미실시한 이유를 보고합니다.
5) 보고: 무엇이, 왜, 어떻게 바뀌었는지 요약하고, 관련 파일 경로/라인을 명시한 뒤 다음 단계 제안을 제공합니다.

## 환경 및 스타일 가이드
- 스택: Flutter 3.24+ / Dart 3+, Windows Desktop 대상. 빌드/런은 Windows 툴체인에서 수행하고, 코드 저장은 WSL 경로(예: `/home/<user>/projects/eyebottlelee`).
- 코드 스타일: 기존 파일의 형식/네이밍을 따릅니다. 자동 포매터는 리포지터리에 설정된 경우에만 사용합니다.
- 주석: 의도, 경계조건, 함수 계약만 간결히 남깁니다.
- 인코딩/EOL: UTF-8, 혼합 금지.
- 문서: 사용법·한계·예시는 `docs/` 또는 관련 파일 상단에 기재합니다. 변경 시 문서와 코드가 불일치하지 않도록 동기화합니다.

## 파일/폴더 관례
- 애플리케이션 코드: `lib/` 하위(services/models/ui 구조 유지). 새로운 서비스/위젯은 기존 디렉터리 패턴을 따른다.
- 플랫폼/스크립트: `windows/`, `scripts/` 하위 규칙 준수. 스크립트 추가 시 실행 방법을 README 또는 해당 폴더의 README에 문서화.
- 자산: 아이콘·이미지는 `assets/icons/`, `assets/images/`에 두고 `pubspec.yaml`을 업데이트.
- 문서: 제품/개발 문서는 `docs/`에 위치하며, 지침 변경 시 AGENTS.md와 함께 갱신한다.
- 민감 정보: 환경 변수/비밀키는 `.env` 또는 시스템 비밀관리 사용. 저장소에 직접 포함하지 않는다.

## 안전/보안 지침
- 비밀정보(토큰/키/개인정보)는 로그와 리포지터리에 남기지 않습니다.
- 의존성 추가/업그레이드는 사용자 승인 후 진행합니다(네트워크 접근 필요).
- 라이선스 호환성 확인 없이 외부 코드/데이터를 포함하지 않습니다.

## Codex CLI 사용 가이드
- 기본 환경: danger-full-access, approval `never` 가정. 명시적으로 제한이 바뀌면 해당 정책을 우선한다.
- 명령 실행 시 항상 `workdir`를 지정하고, 불필요한 `cd` 사용을 피한다.
- 파일 내용 확인은 `cat`, `sed`, `nl` 등 읽기 전용 명령 우선. 검색은 `rg` 기본.
- 네트워크/웹 검색은 사용자가 요청하거나 최신 정보 확인이 필요한 경우에만 수행하며, 필요한 경우 사전 안내 후 실행한다.

## 변경 제안 형식
- 작은 단위로 나누어 `apply_patch`를 사용합니다.
- 한 패치에는 논리적으로 연관된 변경만 포함합니다(예: 코드 + 해당 테스트).
- 새로운 파일 추가 시 헤더/주석/예제를 함께 제공하여 사용 맥락을 분명히 합니다.
- 불필요한 개행·트레일링 스페이스 추가/제거는 피하고, 필요 변경 시 이유를 보고합니다.

## 문서 유지
- 리포지터리 구조나 도구 체계가 바뀌면, 본 문서를 가장 먼저 갱신합니다.
- `docs/medical-recording-prd.md`, `docs/developing.md`의 업데이트가 필요하면 코드 변경과 함께 진행하고, 변경 요약을 최종 보고에 포함합니다.
- 테스트/빌드 절차가 추가되면 INSTALL.md 또는 README.md도 동기화합니다.

---
최종 수정: 2025-09-16
